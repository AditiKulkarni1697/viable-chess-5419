<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      #more {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 5px 5px;
      }
      #more img {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="more"></div>
  </body>
  <script>
    let more = document.getElementById("more");
    let fetchedData2 = [];
    fetch(
      `https://639bfbc642e3ad692723cf3d.mockapi.io/products1?page=1&limit=15`
    )
      .then((responseObject2) => {
        return responseObject2.json();
      })
      .then((actualData2) => {
        fetchedData2 = actualData2;
        warehouse2(actualData2);
      });

    function warehouse2(data2) {
      //console.log(data1);
      more.innerHTML = null;
      data2.forEach((element) => {
        let card2 = document.createElement("div");

        let offer2 = document.createElement("p");
        offer2.innerText = element.offer;

        let image2 = document.createElement("img");
        image2.setAttribute("src", element.image);

        let title2 = document.createElement("p");
        title2.innerText = element.title;

        let price2 = document.createElement("p");
        price2.innerText = element.price;

        let priceoverwritten2 = document.createElement("p");
        priceoverwritten2.innerText = element.priceoverwritten;

        let save2 = document.createElement("p");
        save2.innerText = element.save;

        let cart2 = document.createElement("button");
        cart2.innerText = "Cart";

        cart2.addEventListener("click", function () {
          let cartData = JSON.parse(localStorage.getItem("cart")) || [];
          totalValue = JSON.parse(localStorage.getItem("total")) || 0; //testCase
          let isAlreadyInCart = false;
          for (i = 0; i < cartData.length; i++) {
            if (cartData[i].id === element.id) {
              isAlreadyInCart = true;
              break;
            }
          }
          if (isAlreadyInCart === true) {
            alert("Product Already in Cart");
          } else {
            cartData.push({ ...element, quantity: 1 });
            localStorage.setItem("cart", JSON.stringify(cartData));
            alert("Product Added To Cart");
            let numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
            let priceValue = 0;
            for (i = 0; i < element.price.length; i++) {
              //console.log(element.price[i]);
              for (j = 0; j < numbers.length; j++) {
                if (element.price[i] == numbers[j]) {
                  priceValue += element.price[i];
                }
              }
            }
            totalValue += +priceValue; //price is $24, which is not a number
            localStorage.setItem("total", JSON.stringify(totalValue));
          }
          // let cartData = JSON.parse(localStorage.getItem("cart")) || [];
          // cartData.push(element);
          // console.log(cartData.id);
          // localStorage.setItem("cart", JSON.stringify(cartData));
        });

        more.append(card2);
        card2.append(
          offer2,
          image2,
          title2,
          price2,
          priceoverwritten2,
          save2,
          cart2
        );
      });
    }
  </script>
</html>
